{\rtf1\ansi\ansicpg1252\uc1 \deff0\deflang1036\deflangfe1036{\fonttbl{\f0\froman\fcharset0\fprq2{\*\panose 02020603050405020304}Times New Roman;}{\f28\froman\fcharset238\fprq2 Times New Roman CE;}{\f29\froman\fcharset204\fprq2 Times New Roman Cyr;}
{\f31\froman\fcharset161\fprq2 Times New Roman Greek;}{\f32\froman\fcharset162\fprq2 Times New Roman Tur;}{\f33\froman\fcharset177\fprq2 Times New Roman (Hebrew);}{\f34\froman\fcharset178\fprq2 Times New Roman (Arabic);}
{\f35\froman\fcharset186\fprq2 Times New Roman Baltic;}}{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0;\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;
\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;\red192\green192\blue192;}{\stylesheet{
\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fs24\lang1036\langfe1036\cgrid\langnp1036\langfenp1036 \snext0 Normal;}{\*\cs10 \additive Default Paragraph Font;}{\s15\ql \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 
\fs24\lang1036\langfe1036\cgrid\langnp1036\langfenp1036 \snext15 Standard;}{\*\cs16 \additive \ul\cf2 \sbasedon10 Hyperlink;}{\s17\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 
\fs20\lang1036\langfe1036\cgrid\langnp1036\langfenp1036 \sbasedon0 \snext17 Body Text;}}{\info{\title (((Magazine : PC Team 67)))}{\author Belegar}{\operator Administrateur}{\creatim\yr2001\mo2\dy20\hr22\min30}{\revtim\yr2001\mo2\dy20\hr22\min30}
{\version2}{\edmins0}{\nofpages2}{\nofwords1452}{\nofchars8278}{\*\company The Dwarf Company}{\nofcharsws10165}{\vern8249}}\paperw11906\paperh16838\margl1417\margr1417\margt1417\margb1417 
\deftab708\widowctrl\ftnbj\aenddoc\hyphhotz425\noxlattoyen\expshrtn\noultrlspc\dntblnsbdb\nospaceforul\hyphcaps0\formshade\horzdoc\dgmargin\dghspace180\dgvspace180\dghorigin1417\dgvorigin1417\dghshow1\dgvshow1
\jexpand\viewkind1\viewscale85\viewzk2\pgbrdrhead\pgbrdrfoot\splytwnine\ftnlytwnine\htmautsp\nolnhtadjtbl\useltbaln\alntblind\lytcalctblwd\lyttblrtgr\lnbrkrule \fet0\sectd \linex0\headery708\footery708\colsx708\endnhere\sectlinegrid360\sectdefaultcl 
{\*\pnseclvl1\pnucrm\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl2\pnucltr\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl3\pndec\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl4\pnlcltr\pnstart1\pnindent720\pnhang{\pntxta )}}{\*\pnseclvl5
\pndec\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl6\pnlcltr\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl7\pnlcrm\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl8\pnlcltr\pnstart1\pnindent720\pnhang
{\pntxtb (}{\pntxta )}}{\*\pnseclvl9\pnlcrm\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}\pard\plain \s15\ql \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1036\langfe1036\cgrid\langnp1036\langfenp1036 {\fs20\lang1031\langfe1036\langnp1031 
(((Magazine : PC Team 67)))
\par }{\fs20 (((Rubrique: Team pratik)))
\par (((Sous Rubrique: \'e9lectronique)))
\par 
\par (((titre))) Une t\'e9l\'e9commande pour Winamp
\par 
\par (((chapo)))
\par Avec format MP3, l'ordinateur est devenu une v\'e9ritable machine \'e0 musique. Cependant, il lui manque encore une t\'e9l\'e9commande pour \'eatre totalement fonctionnel. Quoi de mieux pour mettre en pratique nos connaissances sur le port s\'e9rie.

\par 
\par (((texte)))
\par Les deux montages pr\'e9sent\'e9s ici sont ceux les versions les plus utilis\'e9es. De ce fait, ils sont tous deux compatibles avec la grande majorit\'e9 des logiciels que l\rquote 
on peut trouver sur Internet. Mais leur plus grand avantage est sans conteste leur totale compatibilit\'e9 avec n\rquote importe quelle t\'e9l\'e9commande du commerce\~; celle d\rquote une t\'e9l\'e9vision, d\rquote une cha\'eene HI-FI ou, plus pratique, 
de la t\'e9l\'e9commande d\rquote un appareil qui ne sert plus (ou du moins qui n\rquote est pas dans la m\'eame pi\'e8ce). Le syst\'e8me complet se pr\'e9sente sous la forme d\rquote un r\'e9cepteur infrarouge et d\rquote un logiciel associ\'e9
 pour pouvoir exploiter les informations en provenance du capteur. Cela peut \'eatre un logiciel complet permettant de contr\'f4ler tous les \'e9v\'e8nements de Windows ou bien un plug-in donnant la possibilit\'e9 de piloter enti\'e8
rement Winamp. Pour le syst\'e8me de r\'e9ception proprement dit, il est possible de choisir entre deux versions. La premi\'e8re, tr\'e8s simple et peu co\'fbteuse, consiste \'e0 brancher (presque) directement le d\'e9codeur infrarouge au port s\'e9
rie et laisse ainsi au logiciel tout le travail de d\'e9codage. Cependant, cette m\'e9thode est gourmande en ressources et il est beaucoup plus difficile de cr\'e9er son propre "driver" exploitant ce montage. La deuxi\'e8me m\'e9thode met en \'9c
uvre un microcontr\'f4leur 8 bits de la famille PIC qui fournit tout le travail de d\'e9codage. Il dialogue alors avec le PC par l'interm\'e9diaire de l'UART du port s\'e9rie. D\'e8s lors, la programmation d\rquote un logiciel s\rquote en trouve simplifi
\'e9e. Malgr\'e9 la plus grande complexit\'e9 de cette solution, il est possible de s\rquote en sortir facilement en suivant scrupuleusement les instructions de cet article, m\'eame si l'on n\rquote en comprend pas le fonctionnement.
\par 
\par }\pard\plain \ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fs24\lang1036\langfe1036\cgrid\langnp1036\langfenp1036 {\fs20 (((inter))) Principe
\par Un signal infrarouge est transmis par une diode infrarouge situ\'e9e au bout de la t\'e9l\'e9commande. Le r\'e9cepteur est un phototransistor ou une diode r\'e9ceptrice infrarouge. La donn\'e9e \'e9mise par la t\'e9l\'e9commande est modul\'e9e avec un
e porteuse de fr\'e9quence proche des 36KHz. Ainsi, la donn\'e9e a moins de risque \'eatre perturb\'e9e par le "bruit" ambiant. C'est pour cela que l'on va avoir recours non pas \'e0 une simple diode r\'e9ceptrice mais \'e0 un module complet de d\'e9
codage du signal : ainsi, seule l'information (le code de la touche enfonc\'e9e) est disponible en sortie. Plusieurs composants jouent ce r\'f4le, nous utiliserons ici le TSOP1736 (36 repr\'e9
sente les 36KHz de la porteuse) de chez Vishay. Normalement, les modules infrarouges avec les r\'e9f\'e9rences (barbares) suivantes fonctionnent tr\'e8
s bien : SFH506-36, SFH5110-36, GP1U52x, IS1U60L mais il en existe bien d'autres. Quelques documentations sont d\rquote ailleurs regroup\'e9es sur le CD. Ces composants sont vraiment tr\'e8s fiables et fournissent en sortie un signal TTL (0-5V) qui peut 
\'eatre alors trait\'e9 assez facilement. Vous trouverez sur le CD le sch\'e9ma de la  premi\'e8re solution. Le module infrarouge est directement connect\'e9 au port s\'e9rie et est aliment\'e9 par celui ci. Cette m\'e9thode, comme nous l\rquote 
avons dit pr\'e9c\'e9demment, n\'e9cessite une grosse partie de programmation car tout le d\'e9codage se fait par le PC, avec les temps de scrutation cons\'e9quents. Il existe quelques programmes qui g\'e8
rent ce montage, comme WinLIRC (les sources sont disponibles), mais ils sont peu ergonomiques et moins puissants que le sch\'e9ma pr\'e9sent\'e9 ici.
\par 
\par }\pard\plain \s15\ql \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1036\langfe1036\cgrid\langnp1036\langfenp1036 {\fs20 (((inter))) L\rquote UIR
\par Ce r\'e9cepteur est appel\'e9 l\rquote Universal Infrared Receiver pour sa compatibilit\'e9 avec de nombreux logiciels, tous disponibles sur Internet. Celui-ci se r\'e9v\'e8le plus compliqu\'e9 \'e0 fabriquer mais offre une ergonomie et une simplicit\'e9
 d\rquote utilisation incomparables. En effet, un microcontr\'f4leur vient s\rquote intercaler entre le module infrarouge et l\rquote UART du port s\'e9rie. C\rquote est ce composant qui va se charger du d\'e9codage des signaux re\'e7us. Comme le montre l
e sch\'e9ma ci-contre, le dialogue entre le PC et le microcontr\'f4leur est tr\'e8s simple\~: le processeur envoie une s\'e9rie de 6 octets, diff\'e9rents pour chaque bouton de la t\'e9l\'e9commande. D\'e9
velopper son propre programme de gestion devient alors un jeu d\rquote enfant. Le microcontr\'f4leur 8 bits fait parti de la famille bien connue des PIC de Microchip. Il fonctionne \'e0 4MHz et est tr\'e8
s performant pour sa petite taille. Deux versions sont propos\'e9es\~:
\par - l\rquote une \'e0 base d\rquote un 12C509 \'e0 8 broches qui poss\'e8de une m\'e9moire PROM OTP (One Time Programmable, qui n\rquote autorise qu\rquote une seule programmation d\'e9finitive) et se trouve aux alentours de 15F.
\par }\pard\plain \ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fs24\lang1036\langfe1036\cgrid\langnp1036\langfenp1036 {\fs20 - l\rquote autre \'e0 base d\rquote un 16F84 \'e0 18 broches qui poss\'e8de une m\'e9moire FLASH de 2ko\~
; il a l\rquote avantage d\rquote \'eatre re-programmable (\'e0 l\rquote instar des m\'e9moires FLASH des modems par exemple) mais co\'fbte plus cher\~: il faut compter 45F environ.
\par }\pard\plain \s17\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fs20\lang1036\langfe1036\cgrid\langnp1036\langfenp1036 {Quelque soit la solution choisie, il sera n\'e9cessaire de programmer le processeur avec le firmware ad\'e9
quat, les versions pour les deux processeurs \'e9tant disponibles sur le CD-Pro sous forme de fichiers objets. Pour cela, nous vous proposons de r\'e9aliser un petit programmateur pour les composants PIC appel\'e9 JDM (du nom de l\rquote auteur). Puis, 
\'e0 l\rquote aide du programmateur freeware Icprog, on programme la m\'e9moire du microcontr\'f4leur avec le fichier correspondant. Une fois encore, reportez-vous au contenu du CD qui contient toutes les informations utiles et la proc\'e9dure compl\'e8
te de programmation. La r\'e9alisation de ce programmateur ainsi que du module de r\'e9ception n\rquote est pas tr\'e8s compliqu\'e9e car il y a peu de composants. Souder le tout sur une petite plaque \'e0 trous ou \'e0 bandes cuivr\'e9
es sera parfaitement fonctionnel. Si les soudures sont propres et le c\'e2blage r\'e9alis\'e9 soigneusement, tout devrais fonctionner du premier coup. Quelques mesures pr\'e9ventives, valables pour tout montage \'e9lectronique, vous mettra \'e0 l\rquote 
abri des pannes\~: penser \'e0 v\'e9rifier l\rquote alimentation des composants (le PIC et le module de r\'e9ception), faire attention aux soudures et aux courts-circuits (le port s\'e9rie ne craint rien mais le PIC peut en souffrir) et bien s\'fb
r respecter le sch\'e9ma \'e0 la lettre. Ne pas h\'e9siter \'e9galement \'e0 consulter les sites Internet des auteurs des montages car on y trouve souvent une FAQ ou des aides en cas de panne.
\par }\pard\plain \ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fs24\lang1036\langfe1036\cgrid\langnp1036\langfenp1036 {\fs20 
\par (((inter))) Les logiciels
\par }\pard\plain \s17\ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fs20\lang1036\langfe1036\cgrid\langnp1036\langfenp1036 {Voici venu le moment de le tester votre oeuvre. Brancher le circuit au port s\'e9
rie, installer le plug-in Winamp nomm\'e9 gen_ir.dll situ\'e9 sur le CD et d\'e9marrer le lecteur de fichiers MP3. Si aucun message d\rquote erreur  n'appara\'eet durant cette phase, cela signifie que le composant a \'e9t\'e9 programm\'e9 avec succ\'e8
s et que le montage est parfaitement op\'e9rationnel. Dans le cas contraire, v\'e9rifier \'e0 nouveau le niveau de toutes les tensions, le c\'e2blage et que le circuit est branch\'e9 sur le bon port s\'e9rie. Si \'e7
a ne fonctionne toujours pas, le PIC est peut-\'eatre mal programm\'e9 : relancer alors une nouvelle programmation (avec un nouveau composant dans le cas du 12C509). Si le circuit est toujours r\'e9calcitrant, penser \'e0 v\'e9rifier le programmateur en r
\'e9alisant un montage de test (voir l\rquote aide sur le site de l\rquote auteur). En fait, pour tester que la liaison est valide, le plug-in envoie les deux caract\'e8res  'I' et 'R' au PIC et celui-ci, s'il est bien programm\'e9, doit r\'e9
pondre en renvoyant les deux caract\'e8res 'O' et 'K'. Lorsque tout se passe bien, aller dans les param\'e8tres de Winamp, section "Plug-ins", "General Purpose" et cliquer sur "Configure". Appara\'eet alors la fen\'eatre de configuration repr\'e9sent\'e9
e ci-contre. Le but est d'assigner un bouton de la t\'e9l\'e9commande \'e0 un \'e9v\'e8nement de Winamp (passer au titre suivant, faire varier le son ou encore g\'e9rer les playlists). Suivre les indications puis fermer la fen\'eatre et l\'e0
, oh miracle de l'\'e9lectronique, vous pouvez zapper tout comme avec la t\'e9l\'e9. Encore mieux, il est possible \'e0 l'aide des logiciels sur le CD de contr\'f4ler n'importe quelle application Windows en simulant des raccourcis claviers : }{
un lecteur DVD, un logiciel pour vos pr\'e9sentations etc}{. Ou encore, un autre logiciel installe un r\'e9sident en m\'e9moire et permet de d\'e9marrer une application, d'\'e9teindre l'ordinateur ou 
encore de faire bouger le curseur de la souris. Bref, vous n'avez plus qu'\'e0 passer du temps \'e0 configurer tous ces programmes pour avoir une application vraiment fonctionnelle.
\par }\pard\plain \ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fs24\lang1036\langfe1036\cgrid\langnp1036\langfenp1036 {\fs20 
\par (((inter))) Conclusion
\par Nous avons l\'e0 une application qui d\'e9passe le "simple" plug-in Winamp, quoique cette simple utilisation suffirait \'e0 s'y int\'e9resser. Vous trouverez sur le CD-Pro les logiciels n\'e9cessaires pour contr\'f4
ler absolument tous les programmes Windows. Il reste \'e0 placer le circuit dans une petite boite pour \'e9viter d'ab\'eemer les composants. Il est possible \'e9galement de fixer le circuit directement sur le port COM \'e0 l'arri\'e8
re de l'ordinateur et d\rquote utiliser le mur pour la r\'e9flexion du signal. La t\'e9l\'e9commande fonctionne tr\'e8s bien jusqu\rquote \'e0 5m, voire plus selon la qualit\'e9 des \'e9l\'e9ments (r\'e9cepteur, piles de la t\'e9l\'e9
commande etc.). Reliez votre montage au port s\'e9rie avec un c\'e2ble droit, blind\'e9 de pr\'e9f\'e9rence si vous voulez \'e9loigner le r\'e9cepteur \'e0 plus de 2m de votre PC. 
\par 
\par }\pard\plain \s15\ql \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1036\langfe1036\cgrid\langnp1036\langfenp1036 {\fs20 (((signature)))
\par Anthony Rabine - arabine@programmationworld.com
\par }\pard\plain \ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fs24\lang1036\langfe1036\cgrid\langnp1036\langfenp1036 {\fs20 
\par }\pard\plain \s15\ql \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0 \fs24\lang1036\langfe1036\cgrid\langnp1036\langfenp1036 {\fs20 (((images)))
\par elec1.tif : Quel bonheur de t\'e9l\'e9commander Winamp!
\par elec2.tif : Le brochage du TSOP1736.
\par elec3.tif : Un sch\'e9ma simple et tr\'e8s performant.
\par elec4.tif : L'interface du plug-in permet de tout configurer.
\par elec5.tif : A chaque touche de la t\'e9l\'e9commande correspond un code.
\par 
\par (((encadr\'e9)))
\par (((titre))) Bookmark
\par Programmateurs PIC :
\par http://www.rhrk.uni-kl.de/~kiesel/pp2/index.html
\par http://www.h2deetoo.demon.nl/
\par http://www.jdm.homepage.dk/newpics.htm
\par R\'e9cepteurs infrarouges :
\par http://www.geocities.com/SiliconValley/Sector/3863/uir/
\par http://www.epanorama.net/irremote.html
\par Divers :
\par http://www.pcremotecontrol.com/info.html
\par http://www.microchip.com
\par 
\par (((encadr\'e9)))
\par (((titre))) Nomenclature
\par }{\fs20\lang1031\langfe1036\langnp1031 Q1 = quartz \'e0 4MHz
\par D1, D2 = diodes Zener 5,1V
\par }{\fs20 D3, D4 = diodes 1N4148
\par C1, C2 = 15 ou 22pF
\par C3 = 4,7\'b5F polaris\'e9
\par R1 = 1k Ohms
\par }{\fs20\lang1031\langfe1036\langnp1031 R2 =  100k Ohms}{\fs20 
\par }}